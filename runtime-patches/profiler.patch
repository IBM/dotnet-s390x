From e9738ee82bbbe5f77af1cc4f69d577ed1c205341 Mon Sep 17 00:00:00 2001
From: Ilya Leoshkevich <iii@linux.ibm.com>
Date: Tue, 12 Jul 2022 19:01:56 +0200
Subject: [PATCH] Build mono logging profiler on s390x

---
 src/mono/mono/profiler/CMakeLists.txt | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/src/mono/mono/profiler/CMakeLists.txt b/src/mono/mono/profiler/CMakeLists.txt
index 4f860a1c826..3b23b41acc5 100644
--- a/src/mono/mono/profiler/CMakeLists.txt
+++ b/src/mono/mono/profiler/CMakeLists.txt
@@ -10,9 +10,10 @@ include_directories(
   ${PROJECT_SOURCE_DIR}/../sgen)
 
 if(NOT DISABLE_LIBS)
-  if(HOST_ANDROID OR HOST_IOS OR HOST_TVOS)
-    # Build the logging profiler only for mobile platforms
+  if(HOST_ANDROID OR HOST_IOS OR HOST_TVOS OR HOST_S390X)
+    # Build the logging profiler only for certain platforms
     add_library(mono-profiler-log SHARED helper.c log.c log-args.c ${ZLIB_SOURCES})
+    target_compile_definitions(mono-profiler-log PRIVATE -DMONO_DLL_EXPORT)
     target_link_libraries(mono-profiler-log monosgen-shared eglib_objects monoapi)
     if(HOST_ANDROID)
       target_link_libraries(mono-profiler-log log)
-- 
2.31.1

